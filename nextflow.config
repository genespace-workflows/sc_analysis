// Nextflow конфигурация для single-cell RNA-seq pipeline

// Настройки Docker
docker.enabled = true
docker.runOptions = '-u $(id -u):$(id -g)'

// Параметры pipeline
params {
    // Основные пути
    fastq_dir       = "/data/anugumanova/fastq_data"
    reference       = "/data/anugumanova/reference/refdata-gex-mm10-2020-A"
    outdir          = "./results"

    // Опции анализа
    skip_scanpy     = false
}

// Настройки процессов с контейнерами и ресурсами
process {
    withName: FASTQC {
        container = 'quay.io/biocontainers/fastqc:0.12.1--hdfd78af_0'
        cpus = 4
        memory = '8 GB'
        time = '2h'
    }

    withName: CELLRANGER_COUNT {
        container = 'litd/docker-cellranger:v9.0.1'
        cpus = 30
        memory = '90 GB'
        time = '24h'
    }

    withName: MULTIQC {
        container = 'quay.io/biocontainers/multiqc:1.21--pyhdfd78af_0'
        cpus = 2
        memory = '4 GB'
        time = '1h'
    }

    withName: SCANPY_ANALYSIS {
        container = 'gcfntnu/scanpy:1.11.4'
        cpus = 8
        memory = '32 GB'
        time = '8h'
    }
}

// Отчёты Nextflow
timeline {
    enabled = true
    file = "${params.outdir}/pipeline_info/timeline.html"
}

report {
    enabled = true
    file = "${params.outdir}/pipeline_info/report.html"
}

trace {
    enabled = true
    file = "${params.outdir}/pipeline_info/trace.txt"
}

dag {
    enabled = true
    file = "${params.outdir}/pipeline_info/dag.html"
}

// Манифест
manifest {
    name = 'single-cell-rnaseq-pipeline'
    description = 'Pipeline для анализа single-cell RNA-seq данных'
    mainScript = 'main.nf'
    nextflowVersion = '>=23.04.0'
    version = '1.0.0'
}
